<h2>旅ガイドページ詳細</h2>
<div class="flex upper">
  <div class="item left">
    <p class="main_image img">
      <% main_flag_picture = @guide.pictures.find { |picture| picture[:main_flag] == true} %>
      <% if main_flag_picture[:image] != nil %>
        <%= image_tag main_flag_picture.image.url %>
      <% else %>
        まだメイン画像が登録されていません
      <% end %>
    </p>
  </div>
  <div class="item right">
    <p class="data_group">
      <span class="name">ユーザー名:<%= @guide.user.name %></span>
      <span class="favorite_count">お気に入り数:<%= @guide.favorites.count %></span>
      <% if user_signed_in? && @guide.user.id != current_user.id %>
        <% if @favorite.present? %>
          <%= link_to I18n.t('views.messages.do_favorite_deletion'), favorite_path(id: @favorite.id), method: :delete %>
        <% else %>
          <%= link_to I18n.t('views.messages.do_favorite_register'), favorites_path(guide_id: @guide.id), method: :post %>
        <% end %>
      <% end %>
    </p>
    <p class="title"><%= @guide.title %></p>
    <div class="location">
      <p class="address"><%= @guide.prefecture %> <%= @guide.address %></p>
      <div class="note"><%= @guide.note %></div>
    </div>
  </div>
</div>
<div class="content">
  <%= @guide.content %>
</div>
<div class="pictures">
  <% @guide.pictures.each_with_index do |picture, i| %>
    <% if picture[:image] != nil %>
      <span class="picture<%= i %>"><%= image_tag picture.image.url %></span>
    <% else %>
      <span class="picture<%= i %>">まだ登録されていません</span>
    <% end %>
  <% end %>
</div>

<%= link_to I18n.t('views.messages.back_index'), guides_path %>
<% if user_signed_in? && @guide.user.id == current_user.id %>
  <%= link_to I18n.t('views.messages.edit'), edit_guide_path(@guide.id), data: { confirm: I18n.t('views.messages.confirm_edit') } %>
  <%= link_to I18n.t('views.messages.delete'), guide_path(@guide.id), method: :delete ,data: { confirm: I18n.t('views.messages.confirm_delete') } %>
<% end %>
